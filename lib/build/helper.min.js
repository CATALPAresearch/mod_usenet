function search(e){e.preventDefault();let t=new URLSearchParams(window.location.search).get("id");uri=encodeURI("search.php?id="+t+"&searchparam="+$(".form-control").val()),$("#treeinfo").load(uri,(function(e,t,s){"OK"==t&&$("#treeinfo").append("<p>"+e+"</p>")}))}function navigateNext(){if($(".seltrue").attr("column")<$(".seltrue").next().attr("column")){var e=$(".seltrue").next().attr("messageid");let s=new URLSearchParams(window.location.search).get("id");var t=$(".seltrue");$(t).toggleClass("seltrue"),$(t).next().toggleClass("seltrue"),$("#treeinfo").load("messageid.php?id="+s+"&msgnr="+e,(function(e,t,s){$(".seltrue").attr("column")>$(".seltrue").next().attr("column")&&$("#nextbutton").toggleClass("disabled")}));t=$(".seltrue").attr("messageid")}}function navigatePrevius(){if(!$("#previusbutton").hasClass("disabled")&&$(".seltrue").attr("column")>$(".seltrue").prev().attr("column")){var e=$(".seltrue").prev().attr("messageid");let s=new URLSearchParams(window.location.search).get("id");if(parseInt(e)>0){var t=$(".seltrue");$(t).toggleClass("seltrue"),$(t).prev().toggleClass("seltrue"),$("#treeinfo").load("messageid.php?id="+s+"&msgnr="+e,(function(e,t,s){$(".seltrue").attr("column")<$(".seltrue").prev().attr("column")&&$("#previusbutton").toggleClass("disabled")}))}else $("#previusbutton").toggleClass("disabled")}}function answerButton(){var e=$("#answerbutton").text();if(e.indexOf("Antworten")>=0){var t=$("#messagebody").text();$("#messagebody").replaceWith("<div class='form-group shadow-textarea'><textarea class='form-control' id=messagebody cols=90 rows=17/></div>");for(var s=t.split("\n"),a="",r=0;r<s.length;r++)a=a+">"+s[r]+"\n";var n=$("#messagehead").attr("references"),o=$("#messagehead").attr("uid");$("#messagehead").attr("messageid");$("#messagebody").val(a),$("#answerbutton").text("Senden")}else if(e.indexOf("Senden")>=0){var l=$("#subject").text(),i=$("#messagebody").val();n=$("#messagehead").attr("references"),o=$("#messagehead").attr("uid"),$("#messagehead").attr("messageid");l="Re: "+l;let e=new URLSearchParams(window.location.search).get("id");$.post("posttest.php?id="+e+"&msgnr="+$("#messagehead").attr("messageid"),{userInput:i,subject:l,references:n,uid:o},(function(e){})),location.reload(!1)}}function createButton(){$("#treeinfo").empty(),$("#treeinfo").append("<a class='btn btn-primary' id=answerbutton onclick='javascript: sendButton();'>Senden</a><BR>"),$("#treeinfo").append("<label for=subject>Betreff:</label>"),$("#treeinfo").append("<input id=subjectnew class=form-control type=text size=50/>"),$("#treeinfo").append("<label for=messagebody>Text:</label><br/>"),$("#treeinfo").append("<div class='form-group shadow-textarea'><textarea class='form-control' id=messagebody cols=100 rows=19/></div>")}function sendButton(){var e=$("#subjectnew").val();let t=new URLSearchParams(window.location.search).get("id");var s=$("#messagebody").val();$.post("posttest.php?id="+t+"&msgnr=new",{userInput:s,subject:e},(function(e,t){switch(t){case"success":$("#treeinfo").empty(),$("#treeinfo").append("<div class='alert alert-success' role='alert'><h4 class='alert-heading'>Nachricht Versand</h4><p></p><hr><p class='mb-0'><p class='font-weight-bold'></p></p></div>")}}))}