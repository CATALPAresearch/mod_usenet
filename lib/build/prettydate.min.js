/*!
 * Pretty Date v0.1.0
 * https://github.com/fengyuanchen/prettydate
 *
 * Copyright 2014 Fengyuan Chen
 * Released under the MIT license
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}((function(e){"use strict";var t=function(s,a){a=e.isPlainObject(a)?a:{},this.$element=e(s),this.defaults=e.extend({},t.defaults,this.$element.data(),a),this.init()},s=Math.floor,a=864e5,r=7*a,n=365*a;t.prototype={constructor:t,init:function(){var e=this.$element,s=this.defaults,a=e.is("input"),r=a?e.val():e.text();this.isInput=a,this.originalDate=r,this.format=t.fn.parseFormat(s.dateFormat),this.setDate(s.date||r),this.active=!0,this.date&&(this.prettify(),s.autoUpdate&&this.update())},setDate:function(e){e&&(this.date=t.fn.parseDate(e,this.format))},prettify:function(){var e,t=(new Date).getTime()-this.date.getTime(),i=t>0,o=this.defaults.messages,u=this.$element;this.active&&(e=(e=(t=t<0?1e3-t:t)<2e3?o.second:t<6e4?o.seconds.replace("%s",s(t/1e3)):t<12e4?o.minute:t<36e5?o.minutes.replace("%s",s(t/6e4)):t<72e5?o.hour:t<a?o.hours.replace("%s",s(t/36e5)):t<2*a?i?o.yesterday:o.tomorrow:t<3*a?i?o.beforeYesterday:o.afterTomorrow:t<r?o.days.replace("%s",s(t/a)):t<2*r?o.week:t<4*r?o.weeks.replace("%s",s(t/r)):t<53568e5?o.month:t<n?o.months.replace("%s",s(t/26784e5)):t<2*n?o.year:o.years.replace("%s",s(t/n))).replace("%s",i?this.defaults.beforeSuffix:this.defaults.afterSuffix),this.isInput?u.val(e):u.text(e),this.prettyDate=e)},destroy:function(){var e=this.$element,t=this.originalDate;this.active&&(this.defaults.autoUpdate&&this.autoUpdate&&clearInterval(this.autoUpdate),this.isInput?e.val(t):e.text(t),e.removeData("prettydate"),this.active=!1)},update:function(){var e=this.defaults.duration,t=this;"number"==typeof e&&e>0&&(this.autoUpdate=setInterval((function(){t.prettify()}),e))}},t.fn={parseFormat:function(t){var s="string"==typeof t?t.match(/(\w+)/g):[],a=!1;if(!s||0===s.length)throw new Error("Invalid date format.");return t=e.map(s,(function(e){var t=e.substr(0,1);switch(t){case"S":case"s":t="s";break;case"m":t=a?"m":"M",a=!0;break;case"H":case"h":t="h";break;case"D":case"d":t="D";break;case"M":t="M",a=!0;break;case"Y":case"y":t="Y"}return t}))},parseDate:function(t,s){var a="string"==typeof t?t.match(/(\d+)/g):[],r={Y:0,M:0,D:0,h:0,m:0,s:0};return e.isArray(a)&&e.isArray(s)&&a.length===s.length?(e.each(s,(function(e,t){r[t]=parseInt(a[e],10)||0})),r.Y+=r.Y>0&&r.Y<100?2e3:0,t=new Date(r.Y,r.M-1,r.D,r.h,r.m,r.s)):t=new Date(t),t.getTime()?t:null}},t.defaults={afterSuffix:"later",beforeSuffix:"ago",autoUpdate:!1,date:null,dateFormat:"YYYY-MM-DD hh:mm:ss",duration:6e4,messages:{second:"Just now",seconds:"%s seconds %s",minute:"One minute %s",minutes:"%s minutes %s",hour:"One hour %s",hours:"%s hours %s",day:"One day %s",days:"%s days %s",week:"One week %s",weeks:"%s weeks %s",month:"One month %s",months:"%s months %s",year:"One year %s",years:"%s years %s",yesterday:"Yesterday",beforeYesterday:"The day before yesterday",tomorrow:"Tomorrow",afterTomorrow:"The day after tomorrow"}},t.setDefaults=function(s){e.extend(t.defaults,s)},e.fn.prettydate=function(s,a){return this.each((function(){var r=e(this),n=r.data("prettydate");n||r.data("prettydate",n=new t(this,s)),"string"==typeof s&&e.isFunction(n[s])&&n[s](a)}))},e.fn.prettydate.constructor=t,e.fn.prettydate.setDefaults=t.setDefaults,e((function(){e("[prettydate]").prettydate()}))}));