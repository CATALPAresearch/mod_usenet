/**
 * 
 *
 * @module     mod_usenet
 * @class      Post Container
 * @copyright  Niels Seidel <niels.seidel@fernuni-hagen.de> AND Konstantin Friedrich
 * @license    GNU GPLv3
 */
define([M.cfg.wwwroot+"/mod/usenet/amd/src/ReaderPost.js",M.cfg.wwwroot+"/mod/usenet/lib/build/vue.min.js"],(function(s,t){return t.component("post-container",{props:["postlist","markedpost","courseid","showloadingicon","log"],data:function(){return{previouspost:-1}},components:{post:s},watch:{markedpost:function(){if(-1!=this.markedpost){var s=this.postlist[this.markedpost];s.isSelected=!0,s.unread=!1,t.set(this.postlist,this.markedpost,s),-1!=this.previouspost&&this.previouspost!=this.markedpost&&void 0!==this.postlist[this.previouspost]&&((s=this.postlist[this.previouspost]).isSelected=!1,t.set(this.postlist,this.previouspost,s)),this.previouspost=this.markedpost}else if(void 0!==this.postlist[this.previouspost]){let s=this.postlist[this.previouspost];s.isSelected=!1,t.set(this.postlist,this.previouspost,s)}else console.log("oh noe")}},methods:{logger:function(s,t){this.$emit("log",s,t)},ongetmsg:function(s,e){this.$emit("displaymsg",s);var i=this.findinarr(s,this.postlist);e=this.postlist.indexOf(i),i.isSelected=!0,i.unread=!1,t.set(this.postlist,e,i),-1!=this.previouspost&&this.previouspost!=e&&void 0!==this.postlist[this.previouspost]&&((i=this.postlist[this.previouspost]).isSelected=!1,t.set(this.postlist,this.previouspost,i)),this.previouspost=e,window.scroll({top:200,left:0,behavior:"smooth"})},hideChildren:function(s){var t=[];this.traverseChildren(s,t);for(var e=0;e<t.length;e++){let s=parseInt(t[e]);this.$refs[s][0].hideself()}},showChildren:function(s){var t=[];this.traverseChildren(s,t);for(var e=0;e<t.length;e++){let s=parseInt(t[e]);this.$refs[s][0].showself()}},traverseChildren:function(s,t){for(var e=0;e<s.length;e++)Array.isArray(s[e])?this.traverseChildren(s[e],t):t.push(s[e])},setSelectedUP:function(s){this.$emit("setSelected",s)},findinarr:function(s,t){for(let e=0;e<t.length;e++)if(t[e].messagenumber===s)return t[e]}},template:"\n                <div class=\"post-container\">\n                    <div :class=\"{'hidden': showloadingicon, 'text-center': true, 'my-2': true}\" style=\"opacity:0.5;\">\n                        <i class=\"fas fa-circle-o-notch fa-spin fa-3x\"/>\n                    </div>\n                    <post v-for='singlepost in postlist' \n                        v-bind:content='singlepost' \n                        v-bind:key = 'singlepost.messagenumber'\n                        v-bind:courseid = 'courseid'\n                        :ref='singlepost.messagenumber'\n                        v-on:getmsg='ongetmsg'\n                        v-on:hideChildren='hideChildren'\n                        v-on:showChildren='showChildren'\n                        v-on:setSelected='setSelectedUP'\n                        @log='logger'\n                        >\n                    </post>\n                </div>\n                "})}));