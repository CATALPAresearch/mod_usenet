define(["jquery",M.cfg.wwwroot+"/mod/usenet/amd/src/ReaderPost.js",M.cfg.wwwroot+"/mod/usenet/lib/build/vue.min.js"],(function(s,t,e){return e.component("post-container",{props:["postlist","markedpost","courseid","showloadingicon","viewportsize"],data:function(){return{previouspost:-1}},components:{post:t},watch:{markedpost:function(){if(-1!=this.markedpost){var s=this.postlist[this.markedpost];s.isSelected=!0,s.unread=!1,e.set(this.postlist,this.markedpost,s),-1!=this.previouspost&&this.previouspost!=this.markedpost&&void 0!==this.postlist[this.previouspost]&&((s=this.postlist[this.previouspost]).isSelected=!1,e.set(this.postlist,this.previouspost,s)),this.previouspost=this.markedpost}else if(void 0!==this.postlist[this.previouspost]){let s=this.postlist[this.previouspost];s.isSelected=!1,e.set(this.postlist,this.previouspost,s)}else console.log("oh noe")}},methods:{ongetmsg:function(s,t){console.log("try to get msg ",s,t),this.$emit("displaymsg",s);var i=this.findinarr(s,this.postlist);t=this.postlist.indexOf(i),i.isSelected=!0,i.unread=!1,e.set(this.postlist,t,i),-1!=this.previouspost&&this.previouspost!=t&&void 0!==this.postlist[this.previouspost]&&((i=this.postlist[this.previouspost]).isSelected=!1,e.set(this.postlist,this.previouspost,i)),this.previouspost=t,window.scroll({top:200,left:0,behavior:"smooth"})},onhidefamily:function(s){var t=[];this.traversefamily(s,t);for(var e=0;e<t.length;e++){let s=parseInt(t[e]);this.$refs[s][0].hideself()}},onshowfamily:function(s){var t=[];this.traversefamily(s,t);for(var e=0;e<t.length;e++){let s=parseInt(t[e]);this.$refs[s][0].showself()}},traversefamily:function(s,t){for(var e=0;e<s.length;e++)Array.isArray(s[e])?this.traversefamily(s[e],t):t.push(s[e])},setSelectedUP:function(s){this.$emit("setSelected",s)},findinarr:function(s,t){for(let e=0;e<t.length;e++)if(t[e].messagenumber===s)return t[e]}},template:"<div class=\"post-container\">\n                                <div :class=\"{'hidden': showloadingicon, 'text-center': true, 'my-2': true}\" style=\"opacity:0.5;\">\n                                    <i class=\"fas fa-circle-o-notch fa-spin fa-3x\"/>\n                                </div>\n                                <post v-for='singlepost in postlist' \n                                    v-bind:content='singlepost' \n                                    v-bind:key = 'singlepost.messagenumber'\n                                    :viewportsize = 'viewportsize'\n                                    :ref='singlepost.messagenumber'\n                                    v-on:getmsg='ongetmsg'\n                                    v-on:hidefamily='onhidefamily'\n                                    v-on:showfamily='onshowfamily'\n                                    v-on:setSelected='setSelectedUP'\n                                    v-bind:courseid = 'courseid'>\n                                </post>\n                            </div>"})}));