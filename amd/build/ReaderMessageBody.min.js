define(["jquery",M.cfg.wwwroot+"/mod/newsmod/lib/build/vue.min"],(function(t,e){return e.component("messagebody-container",{props:["postdata","isused","isreading","isanswering","iscreatingtopic"],data:function(){return{answerbuttontext:"Antworten",textareacontent:"",value:"",usrinput_subject:"",textarea_usrinput:""}},methods:{onanswerbuttonclick:function(){if(this.answerbuttontext="Antworten"==this.answerbuttontext?"Senden":"Antworten",this.isreading){this.isreading=!1,this.isanswering=!0;for(var t=this.textareacontent.split("\n"),e="\n",n=0;n<t.length;n++)e=e+">"+t[n]+"\n";this.textarea_usrinput=e}else{this.isreading=!0,this.isanswering=!1;const t=new URLSearchParams;t.append("userInput",this.textarea_usrinput),void 0===this.postdata.header&&(this.postdata.header={subject:"",references:"",id:-1}),t.append("subject",this.postdata.header.subject),t.append("references",this.postdata.header.references),t.append("uid",this.postdata.header.id),axios.post(M.cfg.wwwroot+"/mod/newsmod/posttest.php?id="+courseid+"&msgnr="+this.postdata.header.id,t).then(t=>this.value=t),this.$emit("answeredmsg")}},prevmsg:function(){this.$emit("prevmsg",void 0!==this.postdata.header?this.postdata.header.number:0)},nextmsg:function(){this.$emit("nextmsg",void 0!==this.postdata.header?this.postdata.header.number:0)},createtopic:function(){const t=new URLSearchParams;t.append("userInput",this.textareacontent),t.append("subject",this.usrinput_subject),axios.post(M.cfg.wwwroot+"/mod/newsmod/posttest.php?id="+courseid+"&msgnr=new",t).then(t=>this.value=t),this.$emit("answeredmsg")}},watch:{postdata:function(){this.textareacontent=this.postdata.messagebody,this.isreading=!0,this.isanswering=!1,this.answerbuttontext="Antworten"},iscreatingtopic:function(){this.iscreatingtopic&&(this.textarea_usrinput="")}},template:'\n                <div class = "messagebody-container" :style = "{display: isused}">\n                    <div class="row-no-padding" style="padding-right:0px">\n                        <div class="col-xl">\n                            <template v-if = "iscreatingtopic">\n                                <button :class="\'btn btn-primary\'" v-on:click="createtopic">\n                                    Senden\n                                </button>\n                                <BR></BR>\n                                <label>\n                                    Betreff:\n                                </label>\n                                <textarea v-model="usrinput_subject" :class="{\'form-control\': true}" cols=30 rows=1> </textarea>\n                                <label>\n                                    Text:\n                                </label>\n                                <BR></BR>\n                                <textarea v-model="textarea_usrinput" :class="{\'form-control\': true, hidden: isreading}" cols=90 rows=17> </textarea>                        \n                            </template>\n                            <template v-else>\n                                <div v-if="postdata.header !== undefined">{{postdata.header.name}}\n                                </div>\n                                <div v-if="postdata.header !== undefined">{{postdata.header.subject}}\n                                </div>\n                            </template>\n                        </div>\n                    </div>\n\n                    <template v-if = "iscreatingtopic">\n                    </template>\n\n                    <template v-else>\n                        <div class="row">\n                            <button :class="\'btn btn-primary\'" v-on:click="onanswerbuttonclick">\n                                {{answerbuttontext}}\n                            </button>\n                            <button :class="\'btn btn-primary\'" v-on:click="prevmsg">\n                                Vorherige Nachricht\n                            </button>\n                            <button :class="\'btn btn-primary\'" v-on:click="nextmsg">\n                                NÃ¤chste Nachricht\n                            </button>\n                        </div>\n                        <template v-if="isreading">\n                            <div :class="\'row-no-padding\'" :style="{\'overflow-y\': \'scroll\', height: \'335.9px\'}">\n                                <div>\n                                    \x3c!-- \'white-space\': \'pre-line\' is needed here because v-model automatically formats nl it seems --\x3e\n                                    <span :style="{\'white-space\': \'pre-line\'}"> {{textareacontent}}</span>\n                                </div>\n                            </div>\n                        </template>\n                        <template v-else>\n                            <div :class="\'form-group\'" :style="{\'overflow-y\': \'scroll\', height: \'335.9px\'}">\n                                <textarea v-model="textarea_usrinput" :class="{\'form-control\': true, hidden: isreading}" cols=90 rows=17> </textarea>\n                            </div>\n                        </template>\n                    </template>                        \n                </div>\n            '})}));