/**
 * @module     mod/newsmod/Logging
 * @package    mod_newsmod
 * @class      newsmod
 * @copyright  2020 Niels Seidel, niels.seidel@fernuni-hagen.de
 * @license    MIT
 * @since      3.1
 */
define(["jquery","core/ajax"],(function(t,e){return function(t,n,o){this.utils=t,this.courseid=n,this.name="log_newsmod",this.options=t.mergeObjects({outputType:0,prefix:"",loggerServiceUrl:null,loggerServiceParams:{data:{}},context:"default-context"},o),this.ip="",this.add=function(t,e){if("string"!=typeof e){var n={utc:this.getLogTime().utc,location:{host:window.location.host,pathname:window.location.pathname,hash:window.location.hash,tabId:"APLE-MOODLE"===window.name.split("=")[0]?window.name.split("=")[1]:"unknown"},context:this.options.context,action:t,value:e,userAgent:{cpu:navigator.oscpu,platform:navigator.platform,engine:navigator.product,browser:navigator.appCodeName,browserVersion:navigator.appVersion,userAgent:navigator.userAgent.replace(/,/gm,";"),screenHeight:screen.height,screenWidth:screen.width}};this.output(n)}else console.log("warning: uncaptured log entry: "+e)},this.validate=function(t){return t},this.getLogTime=function(){var t=new Date,e=t.getSeconds(),n=t.getMinutes(),o=t.getHours(),i=t.getDate(),a=t.getMonth()+1,s=t.getFullYear();return{utc:t.getTime(),date:s+"-"+(a<=9?"0"+a:a)+"-"+(i<=9?"0"+i:i),time:(o<=9?"0"+o:o)+":"+(n<=9?"0"+n:n)+":"+(e<=9?"0"+e:e)+":"+t.getMilliseconds()}},this.output=function(t){switch(this.options.outputType){case 0:console.log(t);break;case 1:this.sendLog(t)}},this.sendLog=function(t){e.call([{methodname:"mod_newsmod_log",args:{data:{courseid:this.courseid,action:t.action,utc:Math.ceil(t.utc/1e3),entry:JSON.stringify(t)}},done:function(t){},fail:function(t){}}])}}}));